pipeline {
  environment {
    registry = "tarunk0/docker-test"
    registryCredential = ‘dockerhub’
  }
agent {
  kubernetes {
   yaml '''
      apiVersion: v1
      kind: Pod
      spec:
        containers:
        - name: docker
          image: docker:19.03.1-dind
          securityContext:
            privileged: true
          env:
            - name: DOCKER_TLS_CERTDIR
              value: ""
'''
}
}

{
    node(POD_LABEL) {
        container('docker') {
        sh 'docker.build registry + ":$BUILD_NUMBER"'
        }
    }
}
}
